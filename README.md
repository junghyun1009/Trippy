![image-20220819115508105](README.assets/image-20220819115508105.png)

[TOC]



# ğŸ¤¸ Trippy

> ì—¬í–‰ì— íŠ¹í™”ëœ **ì—¬í–‰ ì½”ìŠ¤ ê³µìœ  SNS, Trippy**!
> ë‚˜ì˜ ì—¬í–‰ì„ ë‚´ ì—¬í–‰ ì½”ìŠ¤ ìˆœì„œëŒ€ë¡œ ì‚¬ì§„ê³¼ í•¨ê»˜ ê¸°ë¡í•  ìˆ˜ ìˆëŠ” SNS ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ê¸°ë¡ê³¼ ê³µìœ ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ, ë‹¤ì–‘í•œ ì‚¬ëŒë“¤ê³¼ í•¨ê»˜ í•  ìˆ˜ ìˆëŠ” ê¸°íšŒë¥¼ ë™í–‰ ì°¾ê¸° ì„œë¹„ìŠ¤ë¥¼ í†µí•´ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.
>
> ì°¸ê³ : ëª¨ë°”ì¼ ì „ìš© ì›¹ì´ë¯€ë¡œ **ëª¨ë°”ì¼**ì—ì„œ ê°€ì¥ ìµœì í™”ëœ ìƒíƒœë¡œ ì´ìš©ê°€ëŠ¥í•©ë‹ˆë‹¤

### ğŸ”¸Trippy ë°”ë¡œê°€ê¸°: https://i7a506.p.ssafy.io/

### ğŸ”¸UCC ì˜ìƒ ë°”ë¡œê°€ê¸°: https://youtu.be/udKdfa8RtG4







# ğŸ§¡ ì œì‘ ë°°ê²½ & ì£¼ìš” ê¸°ëŠ¥ ì†Œê°œ

### ğŸ”¸ì œì‘ ë°°ê²½

COVID 19ë¡œ ì–µëˆŒë ¸ë˜ ì—¬í–‰ìš•êµ¬, ì´ì œëŠ” ë¶„ì¶œí•  ë•Œ! ì˜¤ëœ ê¸°ê°„ ì—¬í–‰ì„ ì‰¬ì—ˆë”ë‹ˆ ì—¬í–‰, ì–´ë””ë¡œ ê°€ì•¼í• ì§€ ì–´ë–»ê²Œ ì¤€ë¹„í•´ì•¼í• ì§€ ë§‰ë§‰í•˜ì‹œì£ ? 

Trippyë¥¼ í†µí•´ ë‹¤ë¥¸ ì‚¬ëŒë“¤ì´ ì–´ë–¤ ê³³ì„ ì–´ë–»ê²Œ ë‹¤ë…€ì™”ëŠ”ì§€ ì•Œì•„ë³´ì„¸ìš”! 

TrippyëŠ” íƒ€ SNSì™€ëŠ” ë‹¬ë¦¬ ë‹¤ë¥¸ ì‚¬ëŒì´ ì¼ì • ì§€ì—­ì„ ì—¬í–‰ë‹¤ë‹Œ ì½”ìŠ¤ë¥¼ í•œ ëˆˆì— ì§€ë„ì—ì„œ ë³¼ ìˆ˜ ìˆì–´ ì¼ì • íŒŒì•…ì´ ìš©ì´í•˜ê³ , ëˆ„êµ¬ì™€ ì–´ë–¤ ì´ë™ìˆ˜ë‹¨ì„ ì–¸ì œ ê°”ëŠ”ì§€ë¥¼ ì‰½ê²Œ íŒŒì•…í•  ìˆ˜ ìˆì–´ìš”.



### ğŸ”¸ì£¼ìš” ê¸°ëŠ¥

#### ë‹¤ì´ì–´ë¦¬

* Trippyì˜ í•µì‹¬ ê¸°ëŠ¥ì´ë¼ê³  í•  ìˆ˜ ìˆëŠ” ë‹¤ì´ì–´ë¦¬ì…ë‹ˆë‹¤. 

* ë‹¤ì´ì–´ë¦¬ì—ëŠ” trippy ì´ìš©ìë“¤ì´ ë‹¤ë…€ì˜¨ ì—¬í–‰ì§€ì— ëŒ€í•œ ì •ë³´ê°€ ë‹´ê²¨ìˆëŠ”ë°, í•´ë‹¹ ì •ë³´ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

  ![image-20220819023131170](README.assets/image-20220819023131170.png)

  * ì—¬í–‰ ì¼ì • 
  * ëˆ„êµ¬ì™€ ë‹¤ë…€ì™”ëŠ”ì§€, ëª‡ ëª…ê³¼ í•¨ê»˜ ê°”ëŠ”ì§€
  * ì´ë™ìˆ˜ë‹¨ì´ ë¬´ì—‡ì¸ì§€

* ì—¬í–‰ì§€ì—ì„œì˜ ê²½ë¡œë¥¼ í•œ ëˆˆì— ë³¼ ìˆ˜ ìˆëŠ” ì§€ë„(í•´ì™¸ë„ ê°€ëŠ¥ğŸŒ!)

  ![image-20220819023226182](README.assets/image-20220819023226182.png)

* ê·¸ë¦¬ê³  ì—¬í–‰ ê²½ë¡œë§ˆë‹¤ ìì‹ ë§Œì˜ ì‚¬ì§„ê³¼ ê¸€ì„ ê¸°ë¡í•˜ì—¬ ìì‹ ë§Œì˜ ì—¬í–‰ ì½”ìŠ¤ë¥¼ ì†ì‰½ê²Œ ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

  ![](README.assets/trippy_diary_demo.gif)

  

#### ë™í–‰ì°¾ê¸°

* ì—¬í–‰ì„ ë‹¤ë‹ˆë‹¤ë³´ë©´ í˜¼ìì„œëŠ”, í˜¹ì€ ë‘˜ì´ì„œëŠ” í•  ìˆ˜ ì—†ëŠ” ì¼ë“¤ì´ ë§ì€ ê²ƒì„ ëŠë¼ì…¨ì„ê±°ì˜ˆìš”

* Trippyì˜ ë™í–‰ì°¾ê¸° ê¸°ëŠ¥ì„ ì´ìš©í•œë‹¤ë©´, ë¹„ìŠ·í•œ ì¥ì†Œì— ìœ„ì¹˜í•œ ì‚¬ëŒë“¤ë¼ë¦¬ì˜ ëª¨ì„ì´ ì‰¬ì›Œì§‘ë‹ˆë‹¤!

  

#### ê²Œì´ë¯¸í”¼ì¼€ì´ì…˜

* Trippy ì•ˆì—ì„œì˜ í™œë°œí•˜ê²Œ í™œë™í•œë‹¤ë©´, ê·€ì—¬ìš´ ë±ƒì§€ë„ ê°€ì§ˆ ìˆ˜ ìˆì–´ìš”! 

![image-20220819032040568](README.assets/image-20220819032040568.png)



# ğŸ§¡ ì‚°ì¶œë¬¼

* [ì™€ì´ì–´í”„ë ˆì„&ìŠ¤í† ë¦¬ë³´ë“œ](https://www.figma.com/file/C4MfolSqITjGiE1KPomrWQ/TRIPPY?node-id=0%3A1)
* [ERD](https://www.erdcloud.com/d/22AbgKH3sYpS7jBBA) 
* [API: Swagger](https://github.com/hotsix-turtles/TUPLI/blob/dev/docs/API.md)
* [ì»´í¬ë„ŒíŠ¸êµ¬ì¡°ë„](https://app.diagrams.net/#G1oONA1JfoRr81LHM7TBCpef-x8Y00cLUI)
* [ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨](https://app.diagrams.net/#G1L46-cLTsR_ATDxsFkVIE9gHPdRXvaWOI)

* [ì»¨ë²¤ì…˜](https://www.notion.so/2f3624969a2b48df84561bafe393ecf8)
* [ë””ìì¸](https://second-joke-d45.notion.site/35ac83e8736b40dcb712cfb02feb50fe?v=a92e51533bfc4113852342dd78be3232) 



# ğŸ§¡ í˜‘ì—…

### ğŸ”¸ë¬´ì†¡í•©ë‹ˆë‹¤ íŒ€ì„ ì†Œê°œí•©ë‹ˆë‹¤!

* PPT ëë‚˜ë©´ ê±°ê¸°ì„œ ê°€ì ¸ì˜¬ ì˜ˆì •



### ğŸ”¸í˜‘ì—… íˆ´

- Gitlab
- Jira
- [Notion](https://second-joke-d45.notion.site/TRIPPY-a183e6390df6452cbe07e5d137987aab)
- Mattermost
- Webex



# ğŸ› ï¸ Tech Stack

### ğŸ”¸backend

* IntelliJ IDE
* Springboot 2.7.2
* Spring Data JPA
* Spring Security
* MySQL
* Redis
* QueryDSL
* Swagger 3.0.0



### ğŸ”¸frontend

* Visual Studio Code IDE
* Vue 3.2.37
* Vuex 4.0.2
* Element Plus (UI Framework)



### ğŸ”¸CI/CD

* Docker
* AWS EC2
* Jenkins
* NGINX
* SSL



# âš™ï¸ Installation & Deployment



## ğŸ”¸Ubuntu ê¸°ë³¸ ì„¤ì¹˜

```
sudo apt-get install nodejs
sudo apt-get install npm
```



## ğŸ”¸docker ì„¤ì¹˜

```
# í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜
sudo apt-get install apt-transport-https ca-certificates curl gnupg-agent software-properties-common
# GPG Key ì¸ì¦
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
# docker repository ë“±ë¡
sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"
# ë„ì»¤ ì„¤ì¹˜
sudo apt-get update && sudo apt-get install docker-ce docker-ce-cli containerd.io
# ì‹œìŠ¤í…œ ë¶€íŒ…ì‹œ ë„ì»¤ ì‹œì‘
sudo systemctl enable docker && service docker start
# ë„ì»¤ í™•ì¸
sudo service docker status
```



## ğŸ”¸certbot ì„¤ì¹˜

### Ubuntu 16.04 (LTS), Ubuntu 18.04 (LTS) ì €ì¥ì†Œ ì„¸íŒ…

ì €ì¥ì†Œ ì„¤ì • ë° ì—…ë°ì´íŠ¸ ì§„í–‰

```bash
sudo apt-get update
sudo add-apt-repository universe
sudo add-apt-repository ppa:certbot/certbot
sudo apt-get update
```

### Ubuntu 20.04 (LTS) ì €ì¥ì†Œ ì„¸íŒ…

ì €ì¥ì†Œë¥¼ ì„¤ì • ë° ì—…ë°ì´íŠ¸ ì§„í–‰

```bash
sudo apt-get update
sudo apt-get install software-properties-common
sudo add-apt-repository universe
sudo apt-get update
```

### ê³µí†µ

ê¸°ì¡´ì— ì„¤ì¹˜ëœ Certbot íŒ¨í‚¤ì§€ê°€ ìˆë‹¤ë©´ ì‚­ì œí•©ë‹ˆë‹¤.

$ sudo apt remove certbot

certbot ì„¤ì¹˜

```bash
sudo apt-get install certbot python3-certbot-nginx
```



## ğŸ”¸Nginx ì„¸íŒ…

Certbotì´ ìë™ìœ¼ë¡œ SSLì„ ì„¸íŒ…í•´ì£¼ê¸° ë•Œë¬¸ì— `server block`ê³¼ `server_name`ì„ ì„¤ì •í•´ì£¼ë©´ ë©ë‹ˆë‹¤.

```bash
sudo vim /etc/nginx/sites-available/[your server block]
```

ì•„ë˜ëŠ” ì œ ì˜ˆì‹œì…ë‹ˆë‹¤. `undang_backend_nginx.conf`ì— ë¸”ë¡ë“¤ì´ ìˆê¸° ë•Œë¬¸ì— ì•„ë˜ì²˜ëŸ¼ ë˜ì—ˆìŠµë‹ˆë‹¤.

```
$ sudo vim /etc/nginx/sites-available/undang_backend_nginx.conf
```

ì´ì œ ì„œë²„ ë¸”ë¡ íŒŒì¼ ì•ˆì— server_nameì„ ì„¤ì •í•˜ê³ ì í•˜ëŠ” ë„ë©”ì¸ ì´ë¦„ìœ¼ë¡œ ë³€ê²½í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤. ì €ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

````
...

# configuration of the server

server {

```
# Put your domain next to server_name
server_name undang.twpower.me;
charset     utf-8;

# max upload size
client_max_body_size 75M;   # adjust to taste
```

...

}
````

ì„¤ì •ì´ ì™„ë£Œ ë˜ì—ˆë‹¤ë©´ ì €ì¥í•˜ê³  ì•„ë˜ ëª…ë ¹ì–´ë¥¼ í†µí•´ì„œ ì¬ì‹œì‘í•©ë‹ˆë‹¤.

```bash
$ sudo nginx -t
$ sudo service nginx reload
```



## ğŸ”¸SSL ì¸ì¦ íšë“í•˜ê¸°

ë‹¤ìŒ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ë©´ nginx pluginì„ í†µí•´ì„œ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë„ë©”ì¸ì„ ì¶”ê°€ì ìœ¼ë¡œ ë” í•˜ê³  ì‹¶ë‹¤ë©´(ìœ„ì— server_nameì—ë„ ë¬¼ë¡  ì„¤ì •ì´ ë˜ì–´ìˆì–´ì•¼ê² ì£ ?) `-d` ì˜µì…˜ì„ ì£¼ê³  ë” ì£¼ê°€í•˜ë©´ ë©ë‹ˆë‹¤.

```bash
sudo certbot --nginx -d example.com -d www.example.com
```

ì œ ì˜ˆì‹œëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

```bash
sudo certbot --nginx -d i7a506.p.ssafy.io
```

ê·¸ëŸ¬ë©´ ì•„ë˜ì™€ ê°™ì´ 1ê³¼ 2ë¥¼ ì„ íƒí•˜ëŠ” í™”ë©´ì´ ë‚˜ì˜¤ëŠ”ë° ì €ì™€ ê°™ì€ ê²½ìš°ëŠ” ëª¨ë“  ê²½ìš°ë¥¼ httpsë¡œ í•˜ê³  ì‹¶ì–´ì„œ redirectë¥¼ í—ˆìš©í•˜ëŠ” 2ë²ˆì„ í•˜ì˜€ìŠµë‹ˆë‹¤.

```
## Please choose whether or not to redirect HTTP traffic to HTTPS, removing HTTP access.
-------------------------------------------------------------------------------
## 1: No redirect - Make no further changes to the webserver configuration. 2: Redirect - Make all requests redirect to secure HTTPS access. Choose this for new sites, or if you're confident your site works on HTTPS. You can undo this change by editing your web server's configuration.
-------------------------------------------------------------------------------
Select the appropriate number [1-2] then [enter] (press 'c' to cancel): 2
```



ë²ˆí˜¸ë¥¼ ì„ íƒí•´ì£¼ë©´ ì•„ë˜ì²˜ëŸ¼ ì§„í–‰ë˜ë©° keyë“¤ë„ ìë™ìœ¼ë¡œ ìƒì„±í•´ì¤ë‹ˆë‹¤.

![https://twpower.github.io/images/20170517_44/success.png](https://twpower.github.io/images/20170517_44/success.png)

## ğŸ”¸ì¸ì¦ì„œ ìë™ê°±ì‹  ì„¤ì • í™•ì¸

ì„¤ì •í•œ `certbot`ì€ 90ì¼ ë™ì•ˆë§Œ ìœ íš¨í•˜ê¸° ë•Œë¬¸ì— ê°±ì‹ ì„ í•´ì¤˜ì•¼í•©ë‹ˆë‹¤. ë§¤ë²ˆ í•´ì£¼ê¸° ê·€ì°®ìœ¼ë‚˜ ì„¤ì¹˜í•œ `certbot`ì€ ìë™ìœ¼ë¡œ ê°±ì‹ ì„ ì´í‹€ ë‹¨ìœ„ë¡œ í•´ì¤ë‹ˆë‹¤.

í•´ë‹¹í•˜ëŠ” ê°±ì‹ ì´ ì œëŒ€ë¡œ ë˜ëŠ”ì§€ëŠ” ì•„ë˜ ëª…ë ¹ì–´ë¥¼ í†µí•´ì„œ í™•ì¸ ê°€ëŠ¥í•˜ë©° ì—ëŸ¬ê°€ ë‚˜íƒ€ë‚˜ì§€ ì•Šìœ¼ë©´ renewalì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™ í• ê²ë‹ˆë‹¤.

```bash
sudo certbot renew --dry-run
```

Ubuntuì˜ ê²½ìš° `/etc/cron.d/`ì— ë³´ë©´ `certbot`ì´ ìƒì„±ë˜ì–´ìˆìŠµë‹ˆë‹¤.



## ğŸ”¸ SSL ì ìš© í™•ì¸ ë° í‰ê°€

ë³¸ì¸ì˜ ì„œë²„ì— SSLì´ ì ìš©ì´ ì˜ ë˜ì—ˆëŠ”ì§€ í‰ê°€í•  ìˆ˜ ìˆëŠ” ì—¬ëŸ¬ ì‚¬ì´íŠ¸ê°€ ìˆëŠ”ë° ë“¤ì–´ê°€ì„œ ë³¸ì¸ì˜ ì„œë²„ ë„ë©”ì¸ì„ ì…ë ¥í•˜ë©´ ë©ë‹ˆë‹¤.

https://www.ssllabs.com/ssltest/

![https://twpower.github.io/images/20170517_44/ssl-test.png](https://twpower.github.io/images/20170517_44/ssl-test.png)



## ğŸ”¸Docker ì´ˆê¸°í™”

ì‹¤í–‰ ì¤‘ì¸ ë„ì»¤ ì¤‘, ì´ë¦„ì´ë‚˜ í¬íŠ¸ê°€ ê²¹ì¹  ìœ„í—˜ì´ ìˆê¸° ë•Œë¬¸ì— ì¤‘ì§€ë¥¼ ì‹œí‚µë‹ˆë‹¤.

```
# ë„ì»¤ ì‹œì‘ ì „, ê¸°ì¡´ì— ì‹¤í–‰ì¤‘ì¸ ë„ì»¤ë¥¼ ë©ˆì¶”ê³  ì œê±°í•˜ëŠ” ì‘ì—….
docker ps -f name=frontend -q | xargs --no-run-if-empty docker container stop
docker ps -f name=backend -q | xargs --no-run-if-empty docker container stop

# ì»¨í…Œì´ë„ˆ ì œê±°
docker container ls -a -f name=frontend -q | xargs -r docker container rm
docker container ls -a -f name=backend -q | xargs -r docker container rm'

# ë„ì»¤ ì´ë¯¸ì§€ ì œê±°
docker images -f dangling=true && docker rmi $(docker images -f dangling=true -q)
```



## ğŸ”¸frontend Dockerfile ì´ë¯¸ì§€ ìƒì„± ë° ë¹Œë“œ ì‹¤í–‰

```
docker build -t ygpark96/frontend .
docker run -d -p 8081:80 --name frontend ygpark96/frontend
```

- ì—¬ê¸°ì„œ **/etc/letsencrypt/live/ë„ë©”ì¸ì´ë¦„/** ê²½ë¡œëŠ” SSL ì¸ì¦ í‚¤ê°€ ìˆëŠ” ìœ„ì¹˜ì…ë‹ˆë‹¤. vue.js ë¹Œë“œì™€ nginxê°€ ì‹œì‘ë©ë‹ˆë‹¤.



## ğŸ”¸backend Dockerfile ì´ë¯¸ì§€ ìƒì„± ë° ë¹Œë“œ ì‹¤í–‰

```
docker build -t ygpark96/backend .
docker run -d -p 8080:8080 --name backend ygpark96/backend
```

- springboot Gradle Multi Moduleì„ ì‹œì‘í•©ë‹ˆë‹¤.





